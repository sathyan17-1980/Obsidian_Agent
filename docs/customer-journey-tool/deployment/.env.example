# =============================================================================
# Customer Journey Analysis Tool - Environment Configuration
# Copy this file to .env and fill in your values
# =============================================================================

# =============================================================================
# Application Settings
# =============================================================================
APP_ENV=production  # development, staging, production
LOG_LEVEL=info  # debug, info, warning, error
WORKERS=4  # Number of Uvicorn workers (2 * CPU cores + 1)

# =============================================================================
# Database Settings (PostgreSQL + TimescaleDB)
# =============================================================================
POSTGRES_USER=journey_user
POSTGRES_PASSWORD=CHANGE_ME_SECURE_PASSWORD_HERE  # ⚠️ CHANGE THIS!
POSTGRES_DB=customer_journey

# Database connection pool (for 4GB RAM VPS)
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=10

# Performance tuning
POSTGRES_SHARED_BUFFERS=1GB
POSTGRES_EFFECTIVE_CACHE_SIZE=3GB
POSTGRES_MAINTENANCE_WORK_MEM=256MB
POSTGRES_WORK_MEM=32MB
POSTGRES_MAX_CONNECTIONS=100

# =============================================================================
# Redis Settings
# =============================================================================
REDIS_MAX_CONNECTIONS=50

# =============================================================================
# API Keys
# =============================================================================

# Anthropic API Key (for Pydantic AI agents)
# Get from: https://console.anthropic.com/
ANTHROPIC_API_KEY=sk-ant-YOUR_KEY_HERE  # ⚠️ REQUIRED!

# =============================================================================
# Obsidian Integration
# =============================================================================

# Path to Obsidian vault (inside container)
# Default: /data/obsidian_vault (mapped to Docker volume)
OBSIDIAN_VAULT_PATH=/data/obsidian_vault

# If syncing to local Obsidian vault, mount it:
# docker-compose.yml:
#   volumes:
#     - /path/to/your/ObsidianVault:/data/obsidian_vault

# =============================================================================
# Security
# =============================================================================

# Salt for API key hashing (generate random string)
# Generate with: openssl rand -base64 32
API_KEY_SALT=CHANGE_ME_RANDOM_SALT_HERE  # ⚠️ CHANGE THIS!

# CORS allowed origins (comma-separated)
# Replace with your actual frontend domains
CORS_ORIGINS=https://yourdomain.com,https://www.yourdomain.com,https://app.yourdomain.com

# =============================================================================
# Event Processing Configuration
# =============================================================================

# Maximum events per batch request
MAX_EVENT_BATCH_SIZE=100

# Event processing timeout (seconds)
EVENT_PROCESSING_TIMEOUT=30

# =============================================================================
# Session Configuration
# =============================================================================

# Session timeout (minutes of inactivity)
SESSION_TIMEOUT_MINUTES=30

# =============================================================================
# Performance Limits
# =============================================================================

# Maximum notes to scan for wikilink updates
MAX_WIKILINK_SCAN_NOTES=1000

# Maximum folder depth for traversal
MAX_FOLDER_DEPTH=10

# =============================================================================
# Backup Configuration
# =============================================================================

# Number of days to keep backups
BACKUP_RETENTION_DAYS=7

# =============================================================================
# Domain & SSL Configuration
# =============================================================================

# Your domain name (for Let's Encrypt SSL)
DOMAIN=yourdomain.com  # ⚠️ CHANGE THIS!

# Email for Let's Encrypt notifications
LETSENCRYPT_EMAIL=admin@yourdomain.com  # ⚠️ CHANGE THIS!

# =============================================================================
# Monitoring & Alerts (Optional)
# =============================================================================

# Slack webhook for alerts (optional)
# SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL

# Email alerts (optional)
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_USER=your-email@gmail.com
# SMTP_PASSWORD=your-app-password
# ALERT_EMAIL_TO=alerts@yourdomain.com

# =============================================================================
# Feature Flags (Optional)
# =============================================================================

# Enable/disable features
ENABLE_HEATMAPS=true
ENABLE_SESSION_RECORDINGS=true
ENABLE_REAL_TIME_ALERTS=true
ENABLE_ML_PREDICTIONS=false  # Requires ML models to be trained

# =============================================================================
# Rate Limiting (Already configured in Nginx)
# =============================================================================

# API rate limit (requests per second)
API_RATE_LIMIT=100

# Event ingestion rate limit (requests per second)
EVENT_RATE_LIMIT=1000

# =============================================================================
# Data Retention (TimescaleDB Policies)
# =============================================================================

# How long to keep raw events (days)
EVENTS_RETENTION_DAYS=90

# How long to keep attribute changes (days)
ATTRIBUTE_CHANGES_RETENTION_DAYS=180

# How long to keep funnel metrics (days)
FUNNEL_METRICS_RETENTION_DAYS=365

# =============================================================================
# Development/Testing Settings
# =============================================================================

# Set to 'true' for development only (disables some security features)
# DEBUG=false

# Seed data for testing (development only)
# LOAD_SEED_DATA=false
